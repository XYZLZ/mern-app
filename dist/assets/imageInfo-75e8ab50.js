import{b as x,h as u,j as e,C as H,f as _,r as c,u as E,g as F,k as v,a as s,F as j,l as G,n as J,L as M}from"./index-9105bffc.js";import{d as X,a as Y,H as q,b as K}from"./Card-2bc21d6c.js";import{d as Q}from"./index-80b1f8a7.js";import{D as U}from"./done-9f03b13b.js";import{H as V}from"./Logout-3c8bfdd4.js";import{S as W,R as C}from"./RenderCards-ea13f005.js";import"./FormField-6c9d36c9.js";const Z="/assets/testimonial-f61e1a06.jpg",S=async(t,a)=>{(!t||t=="")&&window.location.replace("/home");try{const o=await(await fetch(`${x}post/this/${t}`,{headers:{authorization:`Bearer ${u}`}})).json();return a({...o.data,newDate:()=>new Date(o.data.createdAt).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}),o.data}catch(n){console.log(n)}},k=async(t,a)=>{try{const o=await(await fetch(`${x}user/likes/${a}`,{headers:{authorization:`Bearer ${u}`}})).json();if(o.success){let l=0;return o.data.forEach(i=>{const r=parseInt(i.heart);l+=r}),t({counter:l,state:o.state}),console.log(o),l}}catch(n){console.log(n)}},ee=async(t,a,n)=>{try{const l=await(await fetch(`${x}user/likes/${n}`,{method:"POST",headers:{authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({likes:1})})).json();if(l.success){const i=await k(a,n);a({counter:i,state:l.state}),console.log(l)}}catch(o){console.log(o)}},te=({data:t,title:a,setAffectedConment:n,affectedConment:o,postId:l,setConments:i})=>(t==null?void 0:t.length)>0?t.map(r=>e(H,{...r,name:r.postedBy.user,date:r.createdAt,text:r.text,avatar:r.postedBy.avatar,userId:r.postedBy._id,setAffectedConment:n,affectedConment:o,postId:l,setConments:i},r._id)):e("h2",{className:"mt-5 font-bold text-[#6449ff] text-xl uppercase",children:a}),me=()=>{var b;const{id:t}=_(),[a,n]=c.useState({name:"",photo:"",prompt:"",photoName:"",category:"",newDate:()=>{}}),[o,l]=c.useState(!1),[i,r]=c.useState(null),[f,T]=c.useState(""),[N,D]=c.useState(null),[$,B]=c.useState(null),[I,p]=c.useState(null),[L,y]=c.useState(!1),[m,g]=c.useState({state:!1,counter:0}),[P,A]=c.useState({type:"",_id:""}),O=E(),R=async h=>{h.preventDefault();const{text:d}=h.target,w=d.value;(await(await fetch(`${x}conment`,{method:"POST",headers:{authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({text:w,postId:t})})).json()).success&&(v(p,t),d.value="")},z=async()=>{l(!0);const h=await S(t,n);try{const d=await fetch(`${x}post/categoryshow/${h.category}`,{method:"GET",headers:{authorization:`Bearer ${u}`}});if(d.ok){const w=await d.json();r(w.data.reverse())}}catch(d){console.log(d)}finally{l(!1)}};return c.useEffect(()=>{(async()=>{u||window.location.replace("/login");const{isGlobal:h,owner:d}=await S(t,n);h===!1&&d._id!=F&&O("/home"),await z(),await v(p,t),await k(g,t)})()},[t]),s(j,{children:[e(V,{}),s("section",{className:"max-w  mx-auto px-4 py-8",children:[s("div",{className:" p-2 mt-16 flex overflow-hidden flex-col lg:flex-row mx-10 md:mx-20 lg:mx-40 rounded-md items-center justify-between bg-white  shadow-lg",children:[e("div",{children:e("img",{src:a.photo,alt:a.photoName,className:" lg:w-[700px] lg:h-[700px] object-cover max-w-[800px] h-full mb-7 lg:mb-0 rounded-md rounded-r-[0px]"})}),s("div",{className:" max-w-[800px] lg:w-[700px] lg:h-[700px]  mx-auto flex flex-col xs:overflow-y-scroll overflow-x-hidden",children:[s("div",{className:"top flex flex-row justify-between mx-4 font-semibold p-4",children:[e("div",{className:"text-white text-sm overflow-y-auto rounded-md bg-indigo-500 inline px-4 py-2",children:a.category}),e("div",{children:a.newDate()})]}),s("div",{className:"text-center p-4",children:[e("h2",{className:"text-black text-2xl lg:text-4xl",children:"Title"}),e("p",{className:"text-gray-700 text-xl lg:text-2xl font-semibold",children:a.photoName})]}),s("div",{className:"mt-28 flex flex-col flex-wrap lg:mt-40 p-4",children:[e("h3",{className:"text-black text-2xl lg:text-4xl text-center",children:"Description"}),e("p",{className:"text-gray-700 text-xl lg:text-2xl text-center mx-auto",children:a.prompt})]}),e("div",{}),s("div",{className:"flex flex-col md:flex-row items-center justify-center md:justify-start gap-10 mt-44 lg:mt-48 ml-3 ",children:[s("div",{id:"owner",className:"flex gap-4 justify-center items-center",children:[a.owner?e("img",{src:(b=a.owner)==null?void 0:b.avatar,alt:"woman",className:"rounded-full w-20 h-20 "}):e("img",{src:Z,alt:"woman",className:"rounded-full w-20 h-20 "}),s("div",{className:"flex flex-col gap-1",children:[e("p",{className:"text-black font-bold",children:"Creator"}),e("span",{className:"font-medium",children:a.name})]})]}),s("div",{className:"flex  gap-5 ml-24",children:[e("button",{type:"button",onClick:()=>Q(a._id,a.photo),className:"outline-none bg-transparent border-none",children:e("img",{src:X,alt:"download",className:"w-6 h-6 object-contain "})}),e(G.CopyToClipboard,{text:a.photo,children:e("button",{type:"button",onClick:()=>{y(!0),setTimeout(()=>{y(!1)},1e3)},className:"outline-none bg-transparent border-none",children:L?e("img",{src:U,alt:"copy",className:"w-6 h-6 object-contain "}):e("img",{src:Y,alt:"copy",className:"w-6 h-6 object-contain "})})}),e("button",{type:"button",onClick:()=>{g({state:!m.state,counter:m.state?m.counter-1:m.counter+1}),ee(m.counter,g,t)},className:"outline-none bg-transparent border-none",children:m.state?s("div",{className:"relative",children:[e("img",{src:q,alt:"copy",className:"w-6 h-6 object-contain relative "}),e("span",{className:"absolute top-7 left-0 bottom-0 right-0 text-xs ",children:m.counter})]}):s("div",{className:"relative",children:[e("img",{src:K,alt:"copy",className:"w-6 h-6 object-contain "}),e("span",{className:"absolute top-7 left-0 bottom-0 right-0 text-xs",children:m.counter})]})})]})]}),e("hr",{className:"mt-1"}),s("div",{className:"mt-10 flex items-center flex-col gap-8 px-8 ",children:[e(J,{handleSubmit:R,formCancel:{state:!1},placeholder:"Leave your comment here"}),e("p",{className:"text-center text-xl text-gray-700 font-bold",children:"All conments"}),e(te,{setConments:p,postId:t,data:I,title:"Not conments",setAffectedConment:A,affectedConment:P})]})]})]}),s("div",{className:"mt-16",children:[e("div",{children:e("h1",{className:"font-extrabold text-[#222328] text-[32px] text-center",children:" You may also like"})}),e("div",{className:"mt-16",children:e(W,{allPost:i,searchText:f,setSearchText:T,searchResults:N,setSearchResults:D,searchTimeOut:$,setSearchTimeOut:B})}),e("div",{className:"mt-10",children:o?e("div",{className:"flex justify-center",children:e(M,{})}):s(j,{children:[f&&s("h2",{className:"font-medium text-[#666e75] text-xl mb-3",children:["Showing results for ",e("span",{className:"text-[#222328]",children:f})]}),e("div",{className:"grid lg:grid-cols-4 sm:grid-cols-3 xs:grid-cols-1 gap-3",children:f?e(C,{data:N,title:"No serch Results found"}):e(C,{data:i,title:"No post found"})})]})})]})]})]})};export{me as default};
