import{b as f,h as c,u as j,r as l,a as r,F as C,j as e,d as z,i as D,e as E,S as m}from"./index-9105bffc.js";import{c as T}from"./index-80b1f8a7.js";import{H as U}from"./Logout-3c8bfdd4.js";const A=async()=>{try{return!!(await(await fetch(`${f}user/id`,{method:"DELETE",headers:{authorization:`Bearer ${c}`}})).json()).success}catch(o){console.log(o)}},q=()=>{const o=j(),[i,u]=l.useState({user:"",email:"",pass:"",avatar:""}),[g,d]=l.useState(""),[p,v]=l.useState(""),y=async t=>{try{const n=await(await fetch(`${f}user/id`,{headers:{authorization:`Bearer ${c}`}})).json(),{user:a,email:w,pass:S,avatar:x}=n.data;u({user:a,email:w,pass:S,avatar:x}),console.log(n)}catch(s){console.log(s)}};l.useEffect(()=>{c||o("/login"),y()},[]);const b=async t=>{t.preventDefault();try{const s=`${f}user/id`,a=await(await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer ${c}`},body:JSON.stringify(i)})).json();return a.error?(console.log(a.error.message),d(a.error.message)):a.message?d(a.message):console.log(a),a.success&&v(a.success),a}catch(s){console.log(s.message)}},N=async t=>{t.preventDefault(),z("usuario").then(async s=>{s.isConfirmed&&D("authorization","please write your email to delete your account","email","Delete Account").then(async n=>{if(n.isConfirmed){const a=n.value||null;a!=null?a===E?(await A(),sessionStorage.removeItem("token"),sessionStorage.removeItem("userId"),sessionStorage.removeItem("user"),sessionStorage.removeItem("userEmail"),sessionStorage.removeItem("memberType"),location.reload()):m("Delete User","unauthorized email","warning"):m("Delete User","unauthorized email","warning")}})})},h=({currentTarget:t})=>{u({...i,[t.name]:t.value})},_=async t=>{const s=t.target.files[0];if(s.size>1048576)return t.target.value="",m("Wrong size","the maximum size is 1MB","warning",5e3),!1;if(s.type=="image/jpeg"||s.type=="image/png"||s.type=="image/jpeg"){const n=await T(t.target.files[0]);u({...i,avatar:n})}else return m("Wrong file","this type of file is not allowed. Only jpg/jpeg/png files","warning",5e3),t.target.value="",!1};return r(C,{children:[e(U,{}),r("div",{className:"mt-0 sm:mx-auto sm:w-full sm:max-w-md",children:[e("h1",{className:"text-center text-black font-bold  text-3xl mb-6",children:"Profile"}),e("div",{className:"bg-white py-8 px-6 shadow rounded-lg sm:px-10 mt-20",children:r("form",{method:"post",className:"mb-0 space-y-6",onSubmit:b,children:[r("div",{children:[e("label",{htmlFor:"user",className:"form__label font-medium",children:"Username"}),e("div",{className:"mt-1",children:e("input",{type:"text",name:"user",value:i.user,className:"form__input",onChange:h,required:!0})})]}),r("div",{children:[e("label",{htmlFor:"email",className:"form__label font-medium",children:"Email Address"}),e("div",{className:"mt-1",children:e("input",{type:"email",name:"email",value:i.email,className:"form__input",onChange:h,required:!0})})]}),r("div",{children:[e("label",{htmlFor:"pass",className:"form__label font-medium",children:"Password"}),e("div",{className:"mt-1",children:e("input",{type:"password",value:i.pass,name:"pass",className:"form__input",onChange:h,required:!0})})]}),r("div",{children:[e("label",{htmlFor:"pass",className:"form__label font-medium",children:"Avatar"}),e("div",{className:"mt-1",children:e("input",{type:"file",className:"form__input",onChange:_,accept:".jpg, .png, .jpeg"})})]}),r("div",{children:[e("div",{className:"mt-1",children:e("button",{type:"submit",className:"form__btn",children:"Update"})}),r("div",{className:"mt-1",children:[e("button",{type:"button",className:"form__btn-danger",onClick:N,children:"Delete User"}),g&&r("div",{className:"error_msg font-medium",children:[g,setTimeout(()=>{d("")},4e3)]}),p&&r("div",{className:"success_msg font-medium",children:[p,setTimeout(()=>{v("")},4e3)]})]})]})]})})]})]})};export{q as default};
